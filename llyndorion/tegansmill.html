function encodeText(text) {
  const usedCoords = new Set();
  const result = [];
  const rows = Object.keys(rawTitles);

  for (let char of text) {
    const upperChar = char.toUpperCase();
    let found = false;

    for (let row of rows) {
      const title = rawTitles[row];
      for (let col = 0; col < title.length; col++) {
        if (title[col].toUpperCase() === upperChar) {
          const coord = `${row}${col + 1}`;
          if (!usedCoords.has(coord)) {
            usedCoords.add(coord);
            result.push(coord);
            found = true;
            break;
          }
        }
      }
      if (found) break;
    }

    if (!found && char.trim() !== '') {
      result.push(char); // fallback: raw character
    }
  }

  return result.join(' ');
}
