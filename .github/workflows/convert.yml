name: Convert
on:
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          ref: TheoryTest # This forces it to ignore 'main' and go to your branch

      - name: Run
        shell: python
        run: |
          import json, csv
          qs = []
          # The script will now look into TheoryTest branch for this file
          with open('questions.txt', 'r', encoding='utf-8') as f:
              for r in csv.reader(f):
                  if len(r) < 9: continue
                  qs.append({"id":r[0],"cat":r[1],"q":r[2],"choices":{"A":r[3],"B":r[4],"C":r[5],"D":r[6]},"correct":r[7],"expl":r[8]})
          with open('questions.json', 'w', encoding='utf-8') as f:
              json.dump(qs, f, indent=2)

      - name: Push
        run: |
          git config user.name "Action"
          git config user.email "action@github.com"
          git add questions.json
          git commit -m "update"
          git push origin TheoryTest
